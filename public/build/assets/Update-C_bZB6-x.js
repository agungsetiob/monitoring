import{g as v,I as q,i as H,c as f,o as y,d as B,a as t,u as k,k as F,b as h,W as I,y as D,m as J,t as a,T as A,q as z,l as S,s as M,D as _,F as O}from"./app-CQcEbXLm.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const $={class:"p-4 min-h-screen bg-pattern md:p-6"},G={class:"mx-auto max-w-4xl"},Q={class:"flex flex-col px-6 py-4 mb-6 text-white bg-gradient-to-r from-teal-500 to-blue-500 rounded-xl shadow-2xl md:flex-row md:items-center md:justify-between"},X={key:0,class:"fixed top-4 right-4 z-50 w-full max-w-sm"},Z={class:"p-4 bg-red-50 rounded-lg border border-red-200 shadow-lg"},tt={class:"flex items-start"},et={class:"flex-1 ml-3"},ot={class:"mt-1 text-sm text-red-700"},at={class:"flex-shrink-0 ml-4"},st={class:"p-6 mb-6 bg-white rounded-xl shadow-lg"},lt={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},nt={class:"flex gap-3"},rt=["disabled"],dt={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},it={key:0,class:"p-6 mb-6 bg-white rounded-xl shadow-lg"},ut={class:"grid grid-cols-1 gap-4 mb-6 md:grid-cols-2"},gt={class:"p-4 bg-gray-50 rounded-lg"},mt={class:"text-lg font-semibold text-gray-900"},ct={class:"p-4 bg-gray-50 rounded-lg"},pt={class:"text-lg font-semibold text-gray-900"},bt={class:"p-4 bg-gray-50 rounded-lg"},xt={class:"text-lg font-semibold text-gray-900"},vt={class:"p-4 bg-gray-50 rounded-lg"},ft={class:"text-lg font-semibold text-gray-900"},yt={class:"p-4 bg-gray-50 rounded-lg"},kt={class:"text-lg font-semibold text-gray-900"},Kt={class:"text-sm text-gray-500"},ht={class:"p-4 bg-gray-50 rounded-lg"},_t={class:"text-lg font-semibold text-gray-900"},wt={class:"text-sm text-gray-500"},Dt={class:"p-4 bg-gray-50 rounded-lg"},St={class:"text-lg font-semibold text-gray-900"},Mt={class:"p-4 bg-gray-50 rounded-lg"},Rt={class:"text-lg font-semibold text-gray-900"},Tt={class:"p-4 bg-gray-50 rounded-lg"},Yt={class:"text-lg font-semibold text-gray-900"},Ct={class:"p-4 bg-gray-50 rounded-lg"},Lt={class:"text-lg font-semibold text-gray-900"},Ut={class:"p-4 bg-gray-50 rounded-lg"},jt={class:"text-lg font-semibold text-gray-900"},Nt={class:"p-4 bg-gray-50 rounded-lg"},Pt={class:"text-lg font-semibold text-gray-900"},Vt={class:"pt-6 border-t border-gray-200"},Bt={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},zt={class:"flex gap-3"},Et=["disabled"],qt={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},Ht={__name:"Update",props:{searchData:{type:Object,default:()=>({})}},setup(Ft){v(!1);const u=v(!1),g=v(!1),s=v(""),o=v(null),l=q({noSuratKontrol:"",tglRencanaKontrol:"",user:"admin"}),R=()=>{s.value=""},w=async()=>{var d,e;if(!l.noSuratKontrol){s.value="Nomor surat kontrol harus diisi";return}u.value=!0,R(),o.value=null;try{const n=await axios.post("/rencana-kontrol/detail",{noSuratKontrol:l.noSuratKontrol});n.data.success?(o.value=n.data.data,console.log(n.data.data),o.value.tglRencanaKontrol&&(l.tglRencanaKontrol=_(o.value.tglRencanaKontrol).format("YYYY-MM-DD")),s.value=""):(o.value=null,s.value=n.data.message)}catch(n){console.error("Error saat mengambil detail:",n),s.value=((e=(d=n.response)==null?void 0:d.data)==null?void 0:e.message)||"Terjadi kesalahan saat mengambil detail data",o.value=null}finally{u.value=!1}},E=async()=>{var e,n,m,c,p,b,x;if(!l.noSuratKontrol||!l.tglRencanaKontrol){s.value="Nomor surat kontrol dan tanggal rencana kontrol harus diisi";return}if(!o.value){s.value="Silakan ambil detail data terlebih dahulu";return}g.value=!0,R();const d={noSuratKontrol:l.noSuratKontrol,noSEP:(e=o.value.sep)==null?void 0:e.noSep,kodeDokter:((n=o.value.dokter)==null?void 0:n.kodeDokter)||o.value.kodeDokter,poliKontrol:o.value.poliTujuan||o.value.poliKontrol,tglRencanaKontrol:l.tglRencanaKontrol,user:l.user};console.log("Data yang akan dikirim untuk update:",d);try{const r=await axios.post("/rencana-kontrol/update",d);r.data.success?(s.value="",await w()):s.value=r.data.message}catch(r){if(console.error("Error saat update:",r),((m=r.response)==null?void 0:m.status)===422&&((p=(c=r.response)==null?void 0:c.data)!=null&&p.errors)){const K=Object.values(r.response.data.errors).flat();s.value="Validation Error: "+K.join(", ")}else s.value=((x=(b=r.response)==null?void 0:b.data)==null?void 0:x.message)||"Terjadi kesalahan saat mengupdate data";setTimeout(()=>{s.value=""},5e3),successMessage.value=""}finally{g.value=!1}};return H(()=>{const e=new URLSearchParams(window.location.search).get("noSuratKontrol");e&&(l.noSuratKontrol=e,w())}),(d,e)=>{var n,m,c,p,b,x,r,K,T,Y,C,L,U,j,N,P,V;return y(),f(O,null,[B(k(F),{title:"Update Tanggal Rencana Kontrol"}),t("div",$,[t("div",G,[t("div",Q,[e[6]||(e[6]=t("h1",{class:"mb-2 text-2xl font-extrabold md:text-3xl md:mb-0"}," Update Tanggal Rencana Kontrol ",-1)),t("button",{onClick:e[0]||(e[0]=i=>k(I).visit("/rencana-kontrol")),class:"inline-flex gap-2 items-center px-5 py-2 font-semibold text-white bg-indigo-600 rounded-xl shadow-lg transition duration-300 ease-in-out transform hover:bg-indigo-700 hover:scale-105"},e[5]||(e[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M19 12H5"}),t("path",{d:"M12 19l-7-7 7-7"})],-1),D(" Kembali ")]))]),B(A,{name:"toast"},{default:J(()=>[s.value?(y(),f("div",X,[t("div",Z,[t("div",tt,[e[9]||(e[9]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"w-5 h-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),t("div",et,[e[7]||(e[7]=t("h3",{class:"text-sm font-medium text-red-800"},"Error!",-1)),t("p",ot,a(s.value),1)]),t("div",at,[t("button",{onClick:e[1]||(e[1]=i=>s.value=""),class:"inline-flex text-red-400 hover:text-red-600 focus:outline-none"},e[8]||(e[8]=[t("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])])])):h("",!0)]),_:1}),t("div",st,[e[12]||(e[12]=t("h2",{class:"mb-4 text-xl font-bold text-gray-800"},"Cari Data Rencana Kontrol",-1)),t("form",{onSubmit:z(w,["prevent"]),class:"space-y-4"},[t("div",lt,[t("div",null,[e[10]||(e[10]=t("label",{for:"noSuratKontrol",class:"block mb-2 text-sm font-medium text-gray-700"}," Nomor Surat Kontrol ",-1)),S(t("input",{id:"noSuratKontrol","onUpdate:modelValue":e[2]||(e[2]=i=>l.noSuratKontrol=i),type:"text",class:"px-3 py-2 w-full rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Masukkan nomor surat kontrol",required:""},null,512),[[M,l.noSuratKontrol]])])]),t("div",nt,[t("button",{type:"submit",disabled:u.value,class:"flex gap-2 items-center px-6 py-2 font-semibold text-white bg-blue-600 rounded-lg transition duration-300 hover:bg-blue-700 disabled:bg-blue-400"},[u.value?(y(),f("svg",dt,e[11]||(e[11]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):h("",!0),D(" "+a(u.value?"Mencari...":"Cari Data"),1)],8,rt)])],32)]),o.value?(y(),f("div",it,[e[29]||(e[29]=t("h3",{class:"mb-4 text-lg font-bold text-gray-800"},"Detail Rencana Kontrol",-1)),t("div",ut,[t("div",gt,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-600"},"Nomor Surat Kontrol",-1)),t("p",mt,a(o.value.noSuratKontrol||"-"),1)]),t("div",ct,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-600"},"Nama Peserta",-1)),t("p",pt,a(((m=(n=o.value.sep)==null?void 0:n.peserta)==null?void 0:m.nama)||"-"),1)]),t("div",bt,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-600"},"Nomor Kartu",-1)),t("p",xt,a(((p=(c=o.value.sep)==null?void 0:c.peserta)==null?void 0:p.noKartu)||"-"),1)]),t("div",vt,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-600"},"Nomor SEP",-1)),t("p",ft,a(((b=o.value.sep)==null?void 0:b.noSep)||"-"),1)]),t("div",yt,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-600"},"Poli Kontrol",-1)),t("p",kt,a(o.value.namaPoliTujuan||"-"),1),t("p",Kt,a(o.value.poliTujuan||"-"),1)]),t("div",ht,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-600"},"Dokter",-1)),t("p",_t,a(((x=o.value.dokter)==null?void 0:x.namaDokter)||o.value.namaDokter||"-"),1),t("p",wt,a(((r=o.value.dokter)==null?void 0:r.kodeDokter)||o.value.kodeDokter||"-"),1)]),t("div",Dt,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-600"},"Tanggal Rencana Kontrol Saat Ini",-1)),t("p",St,a(o.value.tglRencanaKontrol?k(_)(o.value.tglRencanaKontrol).format("DD-MM-YYYY"):"-"),1)]),t("div",Mt,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-600"},"Tanggal Terbit",-1)),t("p",Rt,a(o.value.tglTerbit?k(_)(o.value.tglTerbit).format("DD-MM-YYYY"):"-"),1)]),t("div",Tt,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-600"},"Jenis Kontrol",-1)),t("p",Yt,a(o.value.namaJnsKontrol||"-"),1)]),t("div",Ct,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-600"},"Tanggal Lahir",-1)),t("p",Lt,a((T=(K=o.value.sep)==null?void 0:K.peserta)!=null&&T.tglLahir?k(_)((C=(Y=o.value.sep)==null?void 0:Y.peserta)==null?void 0:C.tglLahir).format("DD-MM-YYYY"):"-"),1)]),t("div",Ut,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-600"},"Jenis Kelamin",-1)),t("p",jt,a(((U=(L=o.value.sep)==null?void 0:L.peserta)==null?void 0:U.kelamin)==="L"?"Laki-laki":((N=(j=o.value.sep)==null?void 0:j.peserta)==null?void 0:N.kelamin)==="P"?"Perempuan":"-"),1)]),t("div",Nt,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-600"},"Hak Kelas",-1)),t("p",Pt,"Kelas "+a(((V=(P=o.value.sep)==null?void 0:P.peserta)==null?void 0:V.hakKelas)||"-"),1)])]),t("div",Vt,[e[28]||(e[28]=t("h4",{class:"mb-4 text-lg font-bold text-gray-800"},"Update Tanggal Rencana Kontrol",-1)),t("form",{onSubmit:z(E,["prevent"]),class:"space-y-4"},[t("div",Bt,[t("div",null,[e[25]||(e[25]=t("label",{for:"tglRencanaKontrol",class:"block mb-2 text-sm font-medium text-gray-700"}," Tanggal Rencana Kontrol Baru ",-1)),S(t("input",{id:"tglRencanaKontrol","onUpdate:modelValue":e[3]||(e[3]=i=>l.tglRencanaKontrol=i),type:"date",class:"px-3 py-2 w-full rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:""},null,512),[[M,l.tglRencanaKontrol]])]),t("div",null,[e[26]||(e[26]=t("label",{for:"user",class:"block mb-2 text-sm font-medium text-gray-700"}," User ",-1)),S(t("input",{id:"user","onUpdate:modelValue":e[4]||(e[4]=i=>l.user=i),type:"text",class:"px-3 py-2 w-full rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Masukkan nama user",required:""},null,512),[[M,l.user]])])]),t("div",zt,[t("button",{type:"submit",disabled:g.value,class:"flex gap-2 items-center px-6 py-2 font-semibold text-white bg-green-600 rounded-lg transition duration-300 hover:bg-green-700 disabled:bg-green-400"},[g.value?(y(),f("svg",qt,e[27]||(e[27]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):h("",!0),D(" "+a(g.value?"Mengupdate...":"Update Tanggal"),1)],8,Et)])],32)])])):h("",!0)])])],64)}}},At=W(Ht,[["__scopeId","data-v-ba9ba37e"]]);export{At as default};
