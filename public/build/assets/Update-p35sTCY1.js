import{g as x,I as O,w as W,i as G,c as g,o as m,d as R,a as e,u as K,k as Q,b,W as X,y as D,m as J,t as s,T as F,q as $,l as T,s as L,D as M,v as Z,F as A,e as ee}from"./app-B-XwmO6T.js";const te={class:"p-4 min-h-screen bg-pattern md:p-6"},ae={class:"mx-auto max-w-8xl"},oe={class:"flex flex-col px-6 py-4 mb-6 text-white bg-gradient-to-r from-teal-500 to-blue-500 rounded-xl shadow-2xl md:flex-row md:items-center md:justify-between"},le={key:0,class:"fixed top-4 right-4 z-50 w-full max-w-sm"},se={class:"p-4 bg-red-50 rounded-lg border border-red-200 shadow-lg"},re={class:"flex items-start"},ne={class:"flex-1 ml-3"},de={class:"mt-1 text-sm text-red-700"},ie={class:"flex-shrink-0 ml-4"},ue={key:0,class:"fixed top-4 right-4 z-50 w-full max-w-sm"},ge={class:"p-4 bg-green-50 rounded-lg border border-green-200 shadow-lg"},me={class:"flex items-start"},ce={class:"flex-1 ml-3"},ve={class:"mt-1 text-sm text-green-700"},pe={class:"flex-shrink-0 ml-4"},xe={class:"p-6 mb-6 bg-white rounded-xl shadow-lg"},be={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},fe={class:"flex gap-3"},ke=["disabled"],ye={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},he={key:0,class:"p-6 mb-6 bg-white rounded-xl shadow-lg"},we={class:"grid grid-cols-1 gap-4 mb-6 md:grid-cols-2"},Ke={class:"p-4 bg-gray-50 rounded-lg"},_e={class:"text-lg font-semibold text-gray-900"},De={class:"p-4 bg-gray-50 rounded-lg"},Te={class:"text-lg font-semibold text-gray-900"},Me={class:"p-4 bg-gray-50 rounded-lg"},Se={class:"text-lg font-semibold text-gray-900"},Re={class:"p-4 bg-gray-50 rounded-lg"},Le={class:"text-lg font-semibold text-gray-900"},je={class:"p-4 bg-gray-50 rounded-lg"},Ce={class:"text-lg font-semibold text-gray-900"},Ye={class:"text-sm text-gray-500"},Pe={class:"p-4 bg-gray-50 rounded-lg"},ze={class:"text-lg font-semibold text-gray-900"},Be={class:"text-sm text-gray-500"},Ue={class:"p-4 bg-gray-50 rounded-lg"},Ne={class:"text-lg font-semibold text-gray-900"},Ve={class:"p-4 bg-gray-50 rounded-lg"},Ee={class:"text-lg font-semibold text-gray-900"},qe={class:"p-4 bg-gray-50 rounded-lg"},He={class:"text-lg font-semibold text-gray-900"},Je={class:"p-4 bg-gray-50 rounded-lg"},Fe={class:"text-lg font-semibold text-gray-900"},$e={class:"p-4 bg-gray-50 rounded-lg"},Ae={class:"text-lg font-semibold text-gray-900"},Ie={class:"p-4 bg-gray-50 rounded-lg"},Oe={class:"text-lg font-semibold text-gray-900"},We={class:"pt-6 border-t border-gray-200"},Ge={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Qe={for:"kodeDokter",class:"block mb-2 text-sm font-medium text-gray-700"},Xe={key:0,class:"text-sm text-blue-600"},Ze=["disabled"],et={value:"",disabled:""},tt=["value"],at={key:0,class:"mt-1 text-sm text-gray-500"},ot={class:"grid grid-cols-1 gap-4 md:grid-cols-1"},lt={class:"flex gap-3"},st=["disabled"],rt={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},it={__name:"Update",props:{searchData:{type:Object,default:()=>({})}},setup(nt){x(!1);const y=x(!1),h=x(!1),f=x(!1),o=x(""),k=x(""),a=x(null),c=x([]),l=O({noSuratKontrol:"",tglRencanaKontrol:"",kodeDokter:"",user:"admin"}),j=()=>{o.value="",k.value=""},S=async(u=!1)=>{var t,r,v,p;if(!l.noSuratKontrol){o.value="Nomor surat kontrol harus diisi",setTimeout(()=>{o.value=""},5e3);return}y.value=!0,u?o.value="":j(),a.value=null;try{const d=await axios.post("/rencana-kontrol/detail",{noSuratKontrol:l.noSuratKontrol});d.data.success?(a.value=d.data.data,a.value.tglRencanaKontrol&&(l.tglRencanaKontrol=M(a.value.tglRencanaKontrol).format("YYYY-MM-DD")),((t=a.value.dokter)!=null&&t.kodeDokter||a.value.kodeDokter)&&(l.kodeDokter=((r=a.value.dokter)==null?void 0:r.kodeDokter)||a.value.kodeDokter),o.value="",await C()):(a.value=null,o.value=d.data.message,setTimeout(()=>{o.value=""},5e3))}catch(d){o.value=((p=(v=d.response)==null?void 0:v.data)==null?void 0:p.message)||"Terjadi kesalahan saat mengambil detail data",a.value=null,setTimeout(()=>{o.value=""},5e3)}finally{y.value=!1}},C=async()=>{var u,t;if(!(!a.value||!l.tglRencanaKontrol)){f.value=!0,c.value=[];try{const r=await axios.post("/rencana-kontrol/jadwal-praktek-dokter",{jnsKontrol:a.value.jnsKontrol,kodePoli:a.value.poliTujuan||a.value.poliKontrol,tglRencanaKontrol:l.tglRencanaKontrol});r.data.success&&r.data.data?(c.value=r.data.data.list,o.value=""):(c.value=[],o.value=r.data.message||"Tidak ada jadwal praktek dokter tersedia",setTimeout(()=>{o.value=""},5e3))}catch(r){console.error("Error saat mengambil jadwal praktek dokter:",r),c.value=[],o.value=((t=(u=r.response)==null?void 0:u.data)==null?void 0:t.message)||"Terjadi kesalahan saat mengambil jadwal praktek dokter",setTimeout(()=>{o.value=""},5e3)}finally{f.value=!1}}},I=async()=>{var t,r,v,p,d,w;if(!l.noSuratKontrol||!l.tglRencanaKontrol){o.value="Nomor surat kontrol dan tanggal rencana kontrol harus diisi",setTimeout(()=>{o.value=""},5e3);return}if(!l.kodeDokter){o.value="Silakan pilih dokter terlebih dahulu",setTimeout(()=>{o.value=""},5e3);return}if(!a.value){o.value="Silakan ambil detail data terlebih dahulu",setTimeout(()=>{o.value=""},5e3);return}h.value=!0,j();const u={noSuratKontrol:l.noSuratKontrol,noSEP:(t=a.value.sep)==null?void 0:t.noSep,kodeDokter:l.kodeDokter,poliKontrol:a.value.poliTujuan||a.value.poliKontrol,tglRencanaKontrol:l.tglRencanaKontrol,user:l.user};try{const i=await axios.post("/rencana-kontrol/update",u);i.data.success?(o.value="",k.value="Data rencana kontrol berhasil diupdate!",setTimeout(async()=>{await S(!0)},1e3),setTimeout(()=>{k.value=""},5e3)):o.value=i.data.message}catch(i){if(console.error("Error saat update:",i),((r=i.response)==null?void 0:r.status)===422&&((p=(v=i.response)==null?void 0:v.data)!=null&&p.errors)){const _=Object.values(i.response.data.errors).flat();o.value="Validation Error: "+_.join(", ")}else o.value=((w=(d=i.response)==null?void 0:d.data)==null?void 0:w.message)||"Terjadi kesalahan saat mengupdate data";setTimeout(()=>{o.value=""},5e3)}finally{h.value=!1}};return W(()=>l.tglRencanaKontrol,async u=>{u&&a.value&&await C()}),G(()=>{const t=new URLSearchParams(window.location.search).get("noSuratKontrol");t&&(l.noSuratKontrol=t,S())}),(u,t)=>{var r,v,p,d,w,i,_,Y,P,z,B,U,N,V,E,q,H;return m(),g(A,null,[R(K(Q),{title:"Update Tanggal Rencana Kontrol"}),e("div",te,[e("div",ae,[e("div",oe,[t[8]||(t[8]=e("h1",{class:"mb-2 text-2xl font-extrabold md:text-3xl md:mb-0"}," Update Tanggal Rencana Kontrol ",-1)),e("button",{onClick:t[0]||(t[0]=n=>K(X).visit("/rencana-kontrol")),class:"inline-flex gap-2 items-center px-5 py-2 font-semibold text-white bg-indigo-600 rounded-xl shadow-lg transition duration-300 ease-in-out transform hover:bg-indigo-700 hover:scale-105"},t[7]||(t[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5"}),e("path",{d:"M12 19l-7-7 7-7"})],-1),D(" Kembali ")]))]),R(F,{name:"toast"},{default:J(()=>[o.value?(m(),g("div",le,[e("div",se,[e("div",re,[t[11]||(t[11]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("div",ne,[t[9]||(t[9]=e("h3",{class:"text-sm font-medium text-red-800"},"Error!",-1)),e("p",de,s(o.value),1)]),e("div",ie,[e("button",{onClick:t[1]||(t[1]=n=>o.value=""),class:"inline-flex text-red-400 hover:text-red-600 focus:outline-none"},t[10]||(t[10]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])])])):b("",!0)]),_:1}),R(F,{name:"toast"},{default:J(()=>[k.value?(m(),g("div",ue,[e("div",ge,[e("div",me,[t[14]||(t[14]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",ce,[t[12]||(t[12]=e("h3",{class:"text-sm font-medium text-green-800"},"Berhasil!",-1)),e("p",ve,s(k.value),1)]),e("div",pe,[e("button",{onClick:t[2]||(t[2]=n=>k.value=""),class:"inline-flex text-green-400 hover:text-green-600 focus:outline-none"},t[13]||(t[13]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])])])):b("",!0)]),_:1}),e("div",xe,[t[17]||(t[17]=e("h2",{class:"mb-4 text-xl font-bold text-gray-800"},"Cari Data Rencana Kontrol",-1)),e("form",{onSubmit:$(S,["prevent"]),class:"space-y-4"},[e("div",be,[e("div",null,[t[15]||(t[15]=e("label",{for:"noSuratKontrol",class:"block mb-2 text-sm font-medium text-gray-700"}," Nomor Surat Kontrol ",-1)),T(e("input",{id:"noSuratKontrol","onUpdate:modelValue":t[3]||(t[3]=n=>l.noSuratKontrol=n),type:"text",class:"px-3 py-2 w-full rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Masukkan nomor surat kontrol",required:""},null,512),[[L,l.noSuratKontrol]])])]),e("div",fe,[e("button",{type:"submit",disabled:y.value,class:"flex gap-2 items-center px-6 py-2 font-semibold text-white bg-blue-600 rounded-lg transition duration-300 hover:bg-blue-700 disabled:bg-blue-400"},[y.value?(m(),g("svg",ye,t[16]||(t[16]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):b("",!0),D(" "+s(y.value?"Mencari...":"Cari Data"),1)],8,ke)])],32)]),a.value?(m(),g("div",he,[t[35]||(t[35]=e("h3",{class:"mb-4 text-lg font-bold text-gray-800"},"Detail Rencana Kontrol",-1)),e("div",we,[e("div",Ke,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-600"},"Nomor Surat Kontrol",-1)),e("p",_e,s(a.value.noSuratKontrol||"-"),1)]),e("div",De,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-600"},"Nama Peserta",-1)),e("p",Te,s(((v=(r=a.value.sep)==null?void 0:r.peserta)==null?void 0:v.nama)||"-"),1)]),e("div",Me,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-600"},"Nomor Kartu",-1)),e("p",Se,s(((d=(p=a.value.sep)==null?void 0:p.peserta)==null?void 0:d.noKartu)||"-"),1)]),e("div",Re,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-600"},"Nomor SEP",-1)),e("p",Le,s(((w=a.value.sep)==null?void 0:w.noSep)||"-"),1)]),e("div",je,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-600"},"Poli Kontrol",-1)),e("p",Ce,s(a.value.namaPoliTujuan||"-"),1),e("p",Ye,s(a.value.poliTujuan||"-"),1)]),e("div",Pe,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-600"},"Dokter",-1)),e("p",ze,s(((i=a.value.dokter)==null?void 0:i.namaDokter)||a.value.namaDokter||"-"),1),e("p",Be,s(((_=a.value.dokter)==null?void 0:_.kodeDokter)||a.value.kodeDokter||"-"),1)]),e("div",Ue,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-600"},"Tanggal Rencana Kontrol Saat Ini",-1)),e("p",Ne,s(a.value.tglRencanaKontrol?K(M)(a.value.tglRencanaKontrol).format("DD-MM-YYYY"):"-"),1)]),e("div",Ve,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-600"},"Tanggal Terbit",-1)),e("p",Ee,s(a.value.tglTerbit?K(M)(a.value.tglTerbit).format("DD-MM-YYYY"):"-"),1)]),e("div",qe,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-600"},"Jenis Kontrol",-1)),e("p",He,s(a.value.namaJnsKontrol||"-"),1)]),e("div",Je,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-600"},"Tanggal Lahir",-1)),e("p",Fe,s((P=(Y=a.value.sep)==null?void 0:Y.peserta)!=null&&P.tglLahir?K(M)((B=(z=a.value.sep)==null?void 0:z.peserta)==null?void 0:B.tglLahir).format("DD-MM-YYYY"):"-"),1)]),e("div",$e,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-600"},"Jenis Kelamin",-1)),e("p",Ae,s(((N=(U=a.value.sep)==null?void 0:U.peserta)==null?void 0:N.kelamin)==="L"?"Laki-laki":((E=(V=a.value.sep)==null?void 0:V.peserta)==null?void 0:E.kelamin)==="P"?"Perempuan":"-"),1)]),e("div",Ie,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-600"},"Hak Kelas",-1)),e("p",Oe,"Kelas "+s(((H=(q=a.value.sep)==null?void 0:q.peserta)==null?void 0:H.hakKelas)||"-"),1)])]),e("div",We,[t[34]||(t[34]=e("h4",{class:"mb-4 text-lg font-bold text-gray-800"},"Update Tanggal Rencana Kontrol",-1)),e("form",{onSubmit:$(I,["prevent"]),class:"space-y-4"},[e("div",Ge,[e("div",null,[t[30]||(t[30]=e("label",{for:"tglRencanaKontrol",class:"block mb-2 text-sm font-medium text-gray-700"}," Tanggal Rencana Kontrol Baru ",-1)),T(e("input",{id:"tglRencanaKontrol","onUpdate:modelValue":t[4]||(t[4]=n=>l.tglRencanaKontrol=n),type:"date",class:"px-3 py-2 w-full rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:""},null,512),[[L,l.tglRencanaKontrol]])]),e("div",null,[e("label",Qe,[t[31]||(t[31]=D(" Pilih Dokter ")),f.value?(m(),g("span",Xe,"(Memuat...)")):b("",!0)]),T(e("select",{id:"kodeDokter","onUpdate:modelValue":t[5]||(t[5]=n=>l.kodeDokter=n),class:"px-3 py-2 w-full rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:f.value||c.value.length===0,required:""},[e("option",et,s(f.value?"Memuat dokter...":c.value.length===0?"Tidak ada dokter tersedia":"Pilih dokter"),1),(m(!0),g(A,null,ee(c.value,n=>(m(),g("option",{key:n.kodeDokter,value:n.kodeDokter},s(n.namaDokter)+" ("+s(n.kodeDokter)+") ",9,tt))),128))],8,Ze),[[Z,l.kodeDokter]]),c.value.length===0&&!f.value&&l.tglRencanaKontrol?(m(),g("p",at," Tidak ada jadwal praktek dokter untuk tanggal yang dipilih ")):b("",!0)])]),e("div",ot,[e("div",null,[t[32]||(t[32]=e("label",{for:"user",class:"block mb-2 text-sm font-medium text-gray-700"}," User ",-1)),T(e("input",{id:"user","onUpdate:modelValue":t[6]||(t[6]=n=>l.user=n),type:"text",class:"px-3 py-2 w-full rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Masukkan nama user",required:""},null,512),[[L,l.user]])])]),e("div",lt,[e("button",{type:"submit",disabled:h.value,class:"flex gap-2 items-center px-6 py-2 font-semibold text-white bg-green-600 rounded-lg transition duration-300 hover:bg-green-700 disabled:bg-green-400"},[h.value?(m(),g("svg",rt,t[33]||(t[33]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):b("",!0),D(" "+s(h.value?"Mengupdate...":"Update Tanggal"),1)],8,st)])],32)])])):b("",!0)])])],64)}}};export{it as default};
