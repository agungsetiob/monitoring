import{D as f,g as n,i as E,w as P,r as H,c as i,o as d,d as m,a as e,b as I,u as b,k as K,W as O,y,t as s,F as k,e as D,n as V}from"./app-17mkc9NW.js";import{d as z}from"./duration-BJ23TIZH.js";import{C as N,r as G,_ as T}from"./chart-DIjpUosM.js";const U={class:"min-h-screen bg-gradient-to-br from-blue-100 to-green-100 px-8 py-10 flex flex-col items-center"},W={class:"w-full max-w-8xl bg-white rounded-2xl shadow-xl p-8 space-y-8"},J={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},Z={class:"bg-white p-6 rounded-xl shadow-md h-[500px] border border-gray-200"},q={class:"bg-blue-50 p-6 rounded-xl shadow-inner"},Q={class:"text-lg text-gray-800"},X={class:"list-disc pl-5 mt-2 text-gray-700"},ee={class:"overflow-x-auto"},te={class:"min-w-full border border-gray-300 rounded-lg overflow-hidden"},ae={class:"px-4 py-2"},se={class:"px-4 py-2"},oe={class:"px-4 py-2"},le={class:"px-4 py-2"},ne={class:"px-4 py-2"},re={class:"px-4 py-2 font-semibold"},ie={class:"flex justify-between items-center mt-6"},de={class:"flex items-center gap-4"},ue=["disabled"],ce={class:"text-gray-700 font-medium"},pe=["disabled"],ge={class:"text-sm text-gray-700"},xe={class:"text-red-600"},ve={key:0,class:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-white bg-opacity-80"},he={__name:"Los",props:{start_date:String,end_date:String},setup(j){f.extend(z),N.register(...G);const x=j,R=n(x.start_date),$=n(x.end_date),C=n(0),r=n({}),L=n([]),l=n(1),v=n(1),u=n(20),h=n(0),c=n(!1),M=async()=>{c.value=!0;try{const t=await(await fetch(`/laporan-los/data?start_date=${R.value}&end_date=${$.value}&page=${l.value}&per_page=${u.value}`)).json();t.success&&(L.value=t.patients,C.value=t.average_los,r.value=t.categories,l.value=t.pagination.page,u.value=t.pagination.per_page,v.value=t.pagination.last_page,h.value=t.pagination.total)}catch(a){console.error("Gagal load data:",a)}finally{c.value=!1}},S=a=>{a<1||a>v.value||(l.value=a,M())};E(M);const A=a=>{const t=f.duration(a,"minutes");return`${t.hours()} jam ${t.minutes()} menit`},F=a=>{O.get(route("laporan.los"),a)},_=n(null);let w=null;const Y={"<1h":"#3B82F6","1-3h":"#10B981","3-6h":"#FACC15","6-7h":"#EF4444",">7h":"#111827"};P(r,()=>{if(!_.value||!r.value)return;const a=Object.keys(r.value),t=Object.values(r.value),p=a.map(o=>Y[o]??"#9CA3AF");w&&w.destroy(),w=new N(_.value,{type:"bar",data:{labels:a,datasets:[{label:"Jumlah Pasien",data:t,backgroundColor:p,borderColor:p,borderWidth:1,borderRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Distribusi Pasien per Kategori LOS",font:{size:18}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}}})}),document.addEventListener("inertia:start",()=>{c.value=!0}),document.addEventListener("inertia:finish",()=>{c.value=!1});function B(a){return a<60?"bg-blue-100 text-blue-600":a<180?"bg-emerald-100 text-emerald-600":a<360?"bg-yellow-100 text-yellow-600":a<420?"bg-red-100 text-red-600":"bg-gray-200 text-gray-700"}return(a,t)=>{const p=H("font-awesome-icon");return d(),i(k,null,[m(b(K),{title:"Laporan LOS IGD"}),e("div",U,[e("div",W,[e("div",J,[t[4]||(t[4]=e("h1",{class:"text-3xl font-extrabold text-gray-800 flex items-center gap-3"}," 🏥 Laporan LOS IGD ",-1)),e("button",{onClick:t[0]||(t[0]=o=>b(O).visit("/laporan")),class:"inline-flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-6 py-3 rounded-xl transition duration-300 ease-in-out transform hover:scale-105"},t[3]||(t[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5"}),e("path",{d:"M12 19l-7-7 7-7"})],-1),y(" Kembali ")]))]),m(T,{"initial-start-date":x.start_date,"initial-end-date":x.end_date,onFilter:F},null,8,["initial-start-date","initial-end-date"]),e("div",Z,[t[5]||(t[5]=e("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"📈 Grafik LOS",-1)),e("canvas",{ref_key:"chartRef",ref:_,class:"w-full max-w-8xl mx-auto"},null,512)]),e("div",q,[t[7]||(t[7]=e("h2",{class:"text-xl font-bold text-blue-700 mb-4"},"📊 Rangkuman",-1)),e("p",Q,[t[6]||(t[6]=e("strong",null,"Rata-rata LOS:",-1)),y(" "+s(C.value)+" jam",1)]),e("ul",X,[(d(!0),i(k,null,D(r.value,(o,g)=>(d(),i("li",{key:g},s(g)+": "+s(o)+" pasien",1))),128))])]),e("div",ee,[e("table",te,[t[8]||(t[8]=e("thead",{class:"bg-blue-600 text-white"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left"},"No"),e("th",{class:"px-4 py-2 text-left"},"NORM"),e("th",{class:"px-4 py-2 text-left"},"Nama"),e("th",{class:"px-4 py-2 text-left"},"Masuk"),e("th",{class:"px-4 py-2 text-left"},"Keluar"),e("th",{class:"px-4 py-2 text-left"},"LOS")])],-1)),e("tbody",null,[(d(!0),i(k,null,D(L.value,(o,g)=>(d(),i("tr",{key:g,class:V(["border-t",B(o.LOS_MINUTES)])},[e("td",ae,s((l.value-1)*u.value+g+1),1),e("td",se,s(o.NORM),1),e("td",oe,s(o.NAMA),1),e("td",le,s(b(f)(o.MASUK).format("DD/MM/YYYY HH:mm")),1),e("td",ne,s(b(f)(o.KELUAR).format("DD/MM/YYYY HH:mm")),1),e("td",re,s(A(o.LOS_MINUTES)),1)],2))),128))])])]),e("div",ie,[e("div",de,[e("button",{onClick:t[1]||(t[1]=o=>S(l.value-1)),disabled:l.value===1,class:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 rounded-lg disabled:opacity-40 disabled:cursor-not-allowed transition"},[m(p,{icon:"chevron-left"}),t[9]||(t[9]=e("span",null,"Sebelumnya",-1))],8,ue),e("span",ce,"Halaman "+s(l.value)+" dari "+s(v.value),1),e("button",{onClick:t[2]||(t[2]=o=>S(l.value+1)),disabled:l.value===v.value,class:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 rounded-lg disabled:opacity-40 disabled:cursor-not-allowed transition"},[t[10]||(t[10]=e("span",null,"Berikutnya",-1)),m(p,{icon:"chevron-right"})],8,pe)]),e("div",ge,[y(" Menampilkan pasien "+s((l.value-1)*u.value+1)+" – "+s(Math.min(l.value*u.value,h.value))+" dari total ",1),e("strong",xe,s(h.value),1),t[11]||(t[11]=y(" pasien "))])])])]),c.value?(d(),i("div",ve,t[12]||(t[12]=[e("video",{src:"/img/loading.webm",autoplay:"",loop:"",muted:"",playsinline:""},null,-1)]))):I("",!0)],64)}}};export{he as default};
