import{D as L,g as u,i as R,c as l,o as n,d as m,b as c,a as t,u as F,k as I,y as N,F as x,e as $,A as y,t as f}from"./app-D8_x93XJ.js";import{d as O}from"./duration-DGWn6DPS.js";import{_ as V}from"./DateFilter-AFvleQrs.js";import K from"./TriageChart-ClVL29CR.js";import H from"./TrendChart-D3naNmZH.js";import"./auto-0DX8mfB2.js";import"./chart-BOVB5OMx.js";const G={key:0,class:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-white bg-opacity-80"},q={class:"min-h-screen bg-gradient-to-br from-blue-100 to-green-100 flex flex-col items-center justify-center px-8 py-10"},J={class:"w-full bg-white rounded-2xl shadow-xl p-8 space-y-8 max-w-full xl:max-w-8xl"},Q={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},U={class:"bg-white p-6 md:p-8 rounded-xl shadow-md border border-gray-200 relative"},W={key:0,class:"absolute inset-0 z-10 bg-white bg-opacity-70 flex items-center justify-center rounded-xl"},X={class:"bg-white p-6 md:p-8 rounded-xl shadow-md border border-gray-200 relative"},Y={key:0,class:"absolute inset-0 z-10 bg-white bg-opacity-70 flex items-center justify-center rounded-xl"},Z={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},ee={class:"bg-white p-6 md:p-8 rounded-xl shadow-md border border-gray-200 relative"},te={key:0,class:"absolute inset-0 z-10 bg-white bg-opacity-70 flex items-center justify-center rounded-xl"},ae={class:"w-full table-auto border-collapse border border-gray-300 rounded-lg overflow-hidden"},re={class:"px-4 py-3 text-gray-700"},se={class:"px-4 py-3 text-gray-700"},oe={class:"bg-white p-6 md:p-8 rounded-xl shadow-md border border-gray-200 relative"},le={key:0,class:"absolute inset-0 z-10 bg-white bg-opacity-70 flex items-center justify-center rounded-xl"},ne={class:"w-full table-auto border-collapse border border-gray-300 rounded-lg overflow-hidden"},ie={class:"px-4 py-3 text-gray-700"},de={class:"px-4 py-3 text-gray-700"},xe={__name:"Triage",props:{start_date:String,end_date:String},setup(M){L.extend(O);const i=M,b=u(!1),o=u({summary:!1,trend:!1,los:!1}),p=u([]),v=u([]),h=u({}),w=u([]),T=async(r,e)=>{var a,s,k,j,C,P;o.value.summary=!0;try{const{data:d}=await y.get(route("laporan.triage.summary"),{params:{start_date:r,end_date:e}});p.value=[{label:"P1",count:((a=d.report)==null?void 0:a.P1)??0,color:"#f87171"},{label:"P2",count:((s=d.report)==null?void 0:s.P2)??0,color:"#f87171"},{label:"P3",count:((k=d.report)==null?void 0:k.P3)??0,color:"#facc15"},{label:"P4",count:((j=d.report)==null?void 0:j.P4)??0,color:"#4ade80"},{label:"P5",count:((C=d.report)==null?void 0:C.P5)??0,color:"#4ade80"},{label:"DOA",count:((P=d.report)==null?void 0:P.DOA)??0,color:"#9ca3af"}],h.value=d.percentages}finally{o.value.summary=!1}},A=async(r,e)=>{o.value.trend=!0;try{const{data:a}=await y.get(route("laporan.triage.daily-trend"),{params:{start_date:r,end_date:e}});v.value=a.daily_trend}finally{o.value.trend=!1}},S=async(r,e)=>{o.value.los=!0;try{const{data:a}=await y.get(route("laporan.triage.average-los"),{params:{start_date:r,end_date:e}});w.value=a.avg_los}finally{o.value.los=!1}},_=async(r,e)=>{try{await Promise.all([T(r,e),A(r,e),S(r,e)])}catch(a){console.error("Error fetching data:",a)}},B=({start_date:r,end_date:e})=>{_(r,e)},D=r=>{const e=L.duration(r,"minutes");return`${e.hours()} jam ${e.minutes()} menit`};R(()=>{_(i.start_date,i.end_date)}),document.addEventListener("inertia:start",()=>{b.value=!0}),document.addEventListener("inertia:finish",()=>{b.value=!1});const g=u(null),E=()=>{var a,s;const r=(s=(a=g.value)==null?void 0:a.exportChartAsImage)==null?void 0:s.call(a);if(!r)return;const e=document.createElement("a");e.href=r,e.download=`triage-${i.start_date}-${i.end_date}.png`,e.click()},z=()=>{var a,s;const r=(s=(a=g.value)==null?void 0:a.exportChartAsImage)==null?void 0:s.call(a);if(!r)return;const e=document.createElement("a");e.href=r,e.download=`triage-harian-${i.start_date}-${i.end_date}.png`,e.click()};return(r,e)=>(n(),l(x,null,[m(F(I),{title:"Laporan Triage"}),b.value?(n(),l("div",G,e[1]||(e[1]=[t("video",{src:"/img/loading.webm",autoplay:"",loop:"",muted:"",playsinline:""},null,-1)]))):c("",!0),t("div",q,[t("div",J,[t("div",Q,[e[3]||(e[3]=t("h1",{class:"text-3xl font-extrabold text-gray-800 flex items-center gap-3"},"📊 Laporan Triage Pasien",-1)),t("button",{onClick:e[0]||(e[0]=a=>r.$inertia.visit("/laporan")),class:"inline-flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-6 py-3 rounded-xl transition duration-300 ease-in-out transform hover:scale-105"},e[2]||(e[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M19 12H5"}),t("path",{d:"M12 19l-7-7 7-7"})],-1),N(" Kembali ")]))]),m(V,{"initial-start-date":i.start_date,"initial-end-date":i.end_date,onFilter:B},null,8,["initial-start-date","initial-end-date"]),t("div",U,[o.value.summary?(n(),l("div",W,e[4]||(e[4]=[t("div",{class:"animate-pulse flex flex-col items-center"},[t("div",{class:"h-8 w-8 bg-blue-400 rounded-full mb-2"})],-1)]))):c("",!0),t("div",{class:"flex items-center justify-between mb-4"},[e[6]||(e[6]=t("h2",{class:"text-xl font-bold text-gray-800"},"📈 Grafik Triage",-1)),t("button",{onClick:E,class:"p-2 rounded-lg bg-green-100 hover:bg-gray-200 transition"},e[5]||(e[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M12 12v6m0 0l-3-3m3 3l3-3M12 4v8"})],-1)]))]),m(K,{data:p.value,ref_key:"triageChartRef",ref:g},null,8,["data"])]),t("div",X,[o.value.trend?(n(),l("div",Y,e[7]||(e[7]=[t("div",{class:"animate-pulse flex flex-col items-center"},[t("div",{class:"h-8 w-8 bg-blue-400 rounded-full mb-2"})],-1)]))):c("",!0),t("div",{class:"flex items-center justify-between mb-4"},[e[9]||(e[9]=t("h2",{class:"text-xl font-bold text-gray-800"},"📈 Tren Harian",-1)),t("button",{onClick:z,class:"p-2 rounded-lg bg-green-100 hover:bg-gray-200 transition"},e[8]||(e[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M12 12v6m0 0l-3-3m3 3l3-3M12 4v8"})],-1)]))]),m(H,{data:v.value,colors:p.value.map(a=>a.color),ref_key:"triageChartRef",ref:g},null,8,["data","colors"])]),t("div",Z,[t("div",ee,[o.value.summary?(n(),l("div",te,e[10]||(e[10]=[t("div",{class:"animate-pulse flex flex-col items-center"},[t("div",{class:"h-8 w-8 bg-blue-400 rounded-full mb-2"})],-1)]))):c("",!0),e[12]||(e[12]=t("h2",{class:"text-xl font-bold mb-4 text-gray-700"},"📊 Persentase Triage",-1)),t("table",ae,[e[11]||(e[11]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left font-semibold text-gray-800"},"Kategori"),t("th",{class:"px-4 py-3 text-left font-semibold text-gray-800"},"Persentase (%)")])],-1)),t("tbody",null,[(n(!0),l(x,null,$(h.value,(a,s)=>(n(),l("tr",{key:s,class:"border-b border-gray-200 last:border-b-0"},[t("td",re,f(s),1),t("td",se,f(a)+"%",1)]))),128))])])]),t("div",oe,[o.value.los?(n(),l("div",le,e[13]||(e[13]=[t("div",{class:"animate-pulse flex flex-col items-center"},[t("div",{class:"h-8 w-8 bg-blue-400 rounded-full mb-2"})],-1)]))):c("",!0),e[15]||(e[15]=t("h2",{class:"text-xl font-bold mb-4 text-gray-700"},"🏥 Rata-rata LOS",-1)),t("table",ne,[e[14]||(e[14]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left font-semibold text-gray-800"},"Kategori"),t("th",{class:"px-4 py-3 text-left font-semibold text-gray-800"},"LOS Rata-rata")])],-1)),t("tbody",null,[(n(!0),l(x,null,$(w.value,a=>(n(),l("tr",{key:a.kategori,class:"border-b border-gray-200 last:border-b-0"},[t("td",ie,f(a.kategori),1),t("td",de,f(D(a.avg_los_minutes)),1)]))),128))])])])])])])],64))}};export{xe as default};
